(function(){"use strict";let c,u=new Uint8Array;function _(){return u.byteLength===0&&(u=new Uint8Array(c.memory.buffer)),u}let p=0;function b(e,n){const t=n(e.length*1);return _().set(e,t/1),p=e.length,t}let f=new Int32Array;function A(){return f.byteLength===0&&(f=new Int32Array(c.memory.buffer)),f}function R(e,n){return _().subarray(e/1,e/1+n)}function C(e,n,t,o,r,i){try{const d=c.__wbindgen_add_to_stack_pointer(-16),h=b(o,c.__wbindgen_malloc),y=p,F=b(r,c.__wbindgen_malloc),j=p;c.derive(d,e,n,t,h,y,F,j,i);var a=A()[d/4+0],s=A()[d/4+1],l=R(a,s).slice();return c.__wbindgen_free(a,s*1),l}finally{c.__wbindgen_add_to_stack_pointer(16)}}async function M(e,n){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,n)}catch(o){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}const t=await e.arrayBuffer();return await WebAssembly.instantiate(t,n)}else{const t=await WebAssembly.instantiate(e,n);return t instanceof WebAssembly.Instance?{instance:t,module:e}:t}}function W(){const e={};return e.wbg={},e}function P(e,n){return c=e.exports,S.__wbindgen_wasm_module=n,f=new Int32Array,u=new Uint8Array,c}async function S(e){typeof e>"u"&&(e="/assets/scrypt_crate_bg.wasm");const n=W();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:t,module:o}=await M(await e,n);return P(t,o)}function E(e){if(/\s/.test(e))throw new Error("Can't contain whitespace");return e=e.replace(/(\w)-(\w)/g,(n,t,o)=>{const r=t.charCodeAt(0),i=o.charCodeAt(0);if(t.length!==1||r>255)throw new Error(`Invalid starting character in range "${n}"`);if(o.length!==1||i>255)throw new Error(`Invalid ending character in range "${n}"`);if(r>i)throw new Error(`Invalid range "${n}"`);let a="";for(let s=r;s<=i;s++)a+=String.fromCharCode(s);return a}),e.replace(/[^\\]-|[^\\]-\W|^-\W|^-\w?/,n=>{throw new Error(`Unterminated range "${n}"`)}),e=e.replace(/\\(.)/g,"$1"),Array.from(new Set(e.split(""))).sort()}const q={allowedChars:"a-zA-Z0-9_.",requiredChars:"",passwordLen:24},T=new Map([["avid.com",{options:{requiredChars:"@"}}],["davidstea.com",{options:{requiredChars:"@"}}],["easyjet.com",{options:{passwordLen:20}}],["facebook.com",{alias:["fb.com"]}],["hrblock.com",{options:{requiredChars:"$"}}],["italki.com",{options:{passwordLen:20}}],["google.com",{alias:["accounts.google.com","gmail.com","youtube.com"]}],["live.com",{alias:["signup.live.com"],options:{requiredChars:"@"}}],["nic.ru",{options:{allowedChars:"a-zA-Z0-9"}}],["nintendo.com",{alias:["accounts.nintendo.com"],options:{requiredChars:"@",passwordLen:20}}],["nyumlc.org",{options:{passwordLen:20}}],["parcelpending.com",{options:{requiredChars:"$@"}}],["paypal.com",{options:{requiredChars:"@",passwordLen:20}}],["pokemon.com",{options:{requiredChars:"@"}}],["redislabs.com",{options:{requiredChars:"$"}}],["rentcafe.com",{options:{requiredChars:"@"}}],["spectrum.net",{options:{passwordLen:20}}],["teladoc.com",{options:{requiredChars:"#"}}],["yahoo.com",{alias:["login.yahoo.com"]}],["ybr.com",{options:{requiredChars:"@",passwordLen:20}}]]),U=new Map;for(const[e,{alias:n=[],options:t={}}]of T)for(const o of[e,...n])U.set(o,{domain:e,options:{...q,...t}});function $({allowedChars:e,requiredChars:n,passwordLen:t},o=q){return e===o.allowedChars&&n===o.requiredChars&&t===o.passwordLen}function O({union:e,passwordLen:n}){return Math.ceil(Math.log2(e.length)*n)}function k(e){let n="";for(let t=0;t<e.length;t++){let o=e[t].toString(16);o.length<2&&(o="0"+o),n+=o}return n}const Y=S(),m=new TextEncoder,I=8,v=32768,L=4,g=32,z=64,B=m.encode("derivepass/aes");function D(e,{required:n,passwordLen:t,allowed:o,union:r}){const i=new Uint8Array([...e].reverse());let a=BigInt("0x"+k(i));const s=new Set(n);let l="";for(;l.length<t;){let d;s.size===0?d=o:s.size===t-l.length?d=Array.from(s):d=r;const h=BigInt(d.length),y=d[Number(a%h)];a=a/h,s.delete(y),l+=y}return l}const K=18,w="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_.".split("");function N(e){if(e.length!==K)throw new Error("Invalid raw bytes");let n="";for(let t=0;t<e.length;t+=3){const o=e[t],r=e[t+1],i=e[t+2];n+=w[o>>>2],n+=w[(o&3)<<4|r>>>4],n+=w[(r&15)<<2|i>>>6],n+=w[i&63]}return n}function Z({master:e},n){const t=`${n.domain}/${n.login}${n.revision>1?`#${n.revision}`:""}`,o=E(n.allowedChars),r=E(n.requiredChars),i=[...new Set([...o,...r])].sort(),a={allowed:o,required:r,union:i,passwordLen:n.passwordLen},s=Math.ceil(O(a)/8),l=C(I,v,L,m.encode(e),m.encode(t),s);return $(n)?N(l):D(l,a)}function x(e){const n=C(I,v,L,m.encode(e),B,g+z);return{master:e,aes:n.slice(0,g),hmac:n.slice(g)}}onmessage=async e=>{await Y;const n=e.data;let t;n.type==="computeKeys"?t={type:"computeKeys",result:x(n.master)}:t={type:"computePassword",result:Z(n.keys,n.app)},postMessage(t)}})();
//# sourceMappingURL=worker.d696367f.js.map